<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>糸掛け曼荼羅 ver1-1</title>
    <script src="https://d3js.org/d3.v5.min.js"></script>
  </head>
  <body>

  </body>
  <script>
    var width = 500;
    var height = 500;
    var centerX = width / 2;
    var centerY = height / 2;
    var radius = 200;
    var svg = d3.select("body").append("svg")
                .attr("width", width)
                .attr("height", height);

    var pinCount = 8;
    var degree = 360 / pinCount;
    var radian = degree * Math.PI / 180;
    var pinPosX = [];
    var pinPosY = [];

    var primeList = [2, 3, 5, 7, 11, 13];

    for(var i = 0; i < pinCount; i++){
      pinPosX.push(centerX + radius * Math.cos(radian * i));
      pinPosY.push(centerY + radius * Math.sin(radian * i));
    }
    var pinPosXY = [];
    for(var i = 0; i < pinCount; i++){
      var pos = [];
      pos.push(pinPosX[i]);
      pos.push(pinPosY[i]);
      pinPosXY.push(pos);
    }

    svg.selectAll("circle")
        .data(pinPosXY)
        .enter()
        .append("circle")
        .attr("r", "3px")
        .attr("cx", function(d){ return d[0]; })
        .attr("cy", function(d){ return d[1]; });

    for(var i = 0; i < primeList.length; i++){
      var step = primeList[i];
      var start = 0;
      var end = step;
      do{
        console.log(end);
        svg.append("line")
            .attr("x1", pinPosXY[start][0])
            .attr("y1", pinPosXY[start][1])
            .attr("x2", pinPosXY[start][0])
            .attr("y2", pinPosXY[start][1])
            .transition()
            .duration(500)
            .attr("x1", pinPosXY[start][0])
            .attr("y1", pinPosXY[start][1])
            .attr("x2", pinPosXY[end][0])
            .attr("y2", pinPosXY[end][1])
            .attr("stroke-width", "2px")
            .attr("stroke", "black");
        start = end;
        end = start + step;
        if(start >= pinPosXY.length) start -= pinPosXY.length;
        if(end >= pinPosXY.length) end -= pinPosXY.length;
      }while(start != 0);
    }


  </script>
</html>
